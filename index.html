<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¸ Guitar Tuner</title>
    <meta name="description" content="Real-time guitar tuner using Web Audio API. No installation required.">
    <meta name="theme-color" content="#1e1e1e">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¸</text></svg>">
    <link rel="stylesheet" href="css/styles.css?v=3">
</head>
<body>

    <!-- Header -->
    <header class="header">
        <h1>ğŸ¸ Guitar Tuner</h1>
        <p>Real-time guitar tuning with frequency detection</p>
    </header>

    <!-- Settings Bar -->
    <div class="settings-bar">
        <div class="setting-group">
            <label for="refFreq">Reference:</label>
            <select id="refFreq" onchange="updateReferenceFreq()">
                <option value="432">432 Hz</option>
                <option value="440" selected>440 Hz (Standard)</option>
                <option value="442">442 Hz</option>
                <option value="444">444 Hz</option>
            </select>
        </div>
        <div class="setting-group">
            <label for="temperament">Tuning:</label>
            <select id="temperament" onchange="updateTemperament()">
                <option value="equal" selected>Equal Temperament</option>
                <option value="just">Just Intonation</option>
            </select>
        </div>
        <div class="setting-group">
            <label for="dbThreshold">Sensitivity:</label>
            <input type="range" id="dbThreshold" min="-60" max="-20" value="-40" onchange="updateThreshold()">
            <span id="dbThresholdVal">-40 dB</span>
        </div>
        <button class="btn-info" onclick="showInfoModal()" title="Learn about tuning settings">â“˜</button>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal-overlay" style="display:none;" onclick="hideInfoModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideInfoModal()">&times;</button>
            <h2>ğŸµ Tuning Information</h2>
            
            <h3>Reference Frequency (A4)</h3>
            <p>The reference frequency determines the pitch of A4, from which all other notes are calculated.</p>
            <ul>
                <li><strong>432 Hz</strong> - "Verdi tuning" - Some believe it sounds warmer and more natural. Used in some classical and new age music.</li>
                <li><strong>440 Hz</strong> - International standard since 1955. Used by most orchestras, bands, and instruments worldwide.</li>
                <li><strong>442 Hz</strong> - Common in European orchestras, especially in Germany and Austria. Slightly brighter tone.</li>
                <li><strong>444 Hz</strong> - Used by some jazz musicians and orchestras for an even brighter sound.</li>
            </ul>
            
            <h3>Temperament System</h3>
            <p>The temperament determines how the 12 notes in an octave are spaced.</p>
            <ul>
                <li><strong>Equal Temperament (12-TET)</strong> - Divides the octave into 12 equal semitones. Standard for modern Western music. Every key sounds equally "in tune" (or equally "out of tune"). Formula: freq = ref Ã— 2^(semitones/12)</li>
                <li><strong>Just Intonation</strong> - Uses pure harmonic ratios (3:2 for fifths, 5:4 for major thirds). Intervals sound purer but only works well in specific keys. Historic tuning, used in some vocal and early music.</li>
            </ul>
            
            <h3>Guitar String Frequencies</h3>
            <table class="info-table">
                <tr><th>String</th><th>Note</th><th>Semitones from A4</th><th>440 Hz</th></tr>
                <tr><td>6 (thickest)</td><td>E2</td><td>-29</td><td>82.41 Hz</td></tr>
                <tr><td>5</td><td>A2</td><td>-24</td><td>110.00 Hz</td></tr>
                <tr><td>4</td><td>D3</td><td>-19</td><td>146.83 Hz</td></tr>
                <tr><td>3</td><td>G3</td><td>-14</td><td>196.00 Hz</td></tr>
                <tr><td>2</td><td>B3</td><td>-10</td><td>246.94 Hz</td></tr>
                <tr><td>1 (thinnest)</td><td>E4</td><td>-5</td><td>329.63 Hz</td></tr>
            </table>
            
            <h3>Tuning Tips</h3>
            <ul>
                <li>ğŸ¯ <strong>Green (Â±5 cents)</strong> - In tune! Perfect.</li>
                <li>ğŸŸ  <strong>Orange (Â±15 cents)</strong> - Close, minor adjustment needed.</li>
                <li>ğŸ”´ <strong>Red (&gt;15 cents)</strong> - Needs significant adjustment.</li>
                <li>ğŸ’¡ Tune in a quiet environment for best results.</li>
                <li>ğŸ’¡ Pluck the string firmly but not too hard.</li>
                <li>ğŸ’¡ Let the note ring - the tuner needs a sustained sound.</li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Left Panel: Controls, Display, String Rows -->
        <div class="left-panel">
            <!-- Control Buttons -->
            <div class="controls">
                <button id="startBtn" class="btn btn-start" onclick="startAudio()">ğŸ¤ Start Microphone</button>
                <button id="stopBtn" class="btn btn-stop" onclick="stopAudio()" disabled>â¹ Stop</button>
                <span id="status" class="status">Click Start to begin</span>
            </div>
            
            <!-- Main Frequency Display -->
            <div class="main-display">
                <div class="freq-line">
                    <span id="hz-val" class="freq-val">----.--</span><span class="freq-unit"> Hz</span>
                    <span style="color: #444;"> | </span>
                    <span id="db-val" class="db-val">---.-</span><span class="db-unit"> dB</span>
                </div>
            </div>
            
            <!-- String Rows (rendered by JavaScript) -->
            <div id="string-rows"></div>
        </div>
        
        <!-- Right Panel: Piano Keyboard -->
        <div class="right-panel">
            <div class="piano-title">âŒ¨ï¸ Piano Keyboard <span style="font-size: 11px; color: #555;">(click to play)</span></div>
            <div id="piano-container" class="piano-container"></div>
        </div>
    </main>

    <!-- JavaScript (load order matters) -->
    <script src="js/config.js?v=2"></script>
    <script src="js/audio.js?v=2"></script>
    <script src="js/ui.js?v=2"></script>
    <script src="js/app.js?v=2"></script>

</body>
</html>
